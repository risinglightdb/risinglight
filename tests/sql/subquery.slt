# Test subquery 

statement ok
create table t(a int, b int);

statement ok
insert into t values (1, 2), (3, 4);

query II
select a, b from (select a, b from t);
----
1 2
3 4

query II
select x.a, x.b from (select a, b from t) as x;
----
1 2
3 4

query II
select * from (select a, b from t);
----
1 2
3 4

query I
select s from (select a + b as s from t);
----
3
7

query II rowsort
select a, b from (select b from t), (select a from t);
----
1 2
1 4
3 2
3 4

query II rowsort
select x.a, y.a from 
    (select -a as a from t) as x,
    (select -b as a from t) as y;
----
-1 -2
-1 -4
-3 -2
-3 -4

query error duplicated alias
select a, b from t, t;

query error ambiguous column
select a, b from t, t as t1;

query IIII
select t.a, t.b, t1.a, t1.b from t, t as t1;
----
1 2 1 2
3 4 1 2
1 2 3 4
3 4 3 4

# count(*) from different tables should be distinct
query II
select c2, c1 from
    (select count(*) as c1 from t where a = 1),
    (select count(*) as c2 from t);
----
2 1

# row_number() from different tables should be distinct
query II rowsort
select c2, c1 from
    (select row_number() over () as c1 from t where a = 1),
    (select row_number() over () as c2 from t);
----
1 1
2 1

# columns from CTE should be distinct
query II
with t(a) as (select a from t)
select t1.a, t.a from t, t as t1;
----
1 1
3 1
1 3
3 3
